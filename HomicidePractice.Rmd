---
title: "Homicidepractice"
author: "Christine Iyer"
date: "May 7, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)


```


```{r}
library(dplyr)
library(tidyr)
library(data.table)
library(zoo)
library(knitr)
library(ggplot2)
```


```{r, message=FALSE, warning=FALSE}
#Dates
setwd("/Users/Chris Iyer/Documents/R/myrepo/Homicide/")
homicide <- read.csv("Homicide.csv")
homicide <- as_data_frame(homicide)
homicide1 <-  homicide %>% select(Month, Year)
homicide1 <- homicide1 %>% mutate(month = ifelse(Month == "January", "01",
 ifelse(Month == "February", "02",ifelse(Month == "March", "03",
 ifelse(Month == "April", "04",ifelse(Month == "May", "05",
 ifelse(Month == "June", "06",ifelse(Month == "July", "07",
 ifelse(Month == "August", "08",ifelse(Month == "September", "09",
 ifelse(Month == "October", "10",ifelse(Month == "November", "11","12"))))))))))))
homicide1$Year <- as.character(homicide1$Year)
homicide1 <- transform(homicide1, newcol = paste(Year,"/", month,"/01", sep = ""))
homicide1$newcol <-  as.Date(homicide1$newcol, format = "%Y/%m/%d")
class(homicide1$newcol)
homicide1 <- homicide1 %>% select(Date = newcol)
Homicide <- cbind.data.frame(homicide1, homicide)
Homicide <- Homicide %>% select(1, 6:8, 10:23)
head(Homicide)



# set.seed(201)
# d <- Homicide[sample(nrow(Homicide), 100), ]
# dim(d)
```


```{r}
#x <- plot(subset(Homicide, Perpetrator.Race %in% c("Black", "White", aes(x = Year, y = cumsum(rowsum(Homicide$Year)), type = ""))))
head(mpg)
ggplot(Homicide,aes(Perpetrator.Race)) + geom_bar(aes(fill = Victim.Race))

```


```{r}
#Black and White on Black on White
BlackonWhite <- Homicide %>% filter(Perpetrator.Race == "Black" & Victim.Race=="White") %>% select(Date, Year, City, State, Perpetrator.Race, Victim.Race, Weapon,Incident)
head(BlackonWhite)
dim(BlackonWhite)
```

```{r}
byWeapBonW <- group_by(BlackonWhite, Weapon) 
head(byWeapBonW)
```

```{r}
BlonWhYear <- group_by(byWeapBonW, Year)
head(BlonWhYear)
dim(BlonWhYear)
names(BlonWhYear)
```


```{r}
WhiteonBlack <- Homicide %>% filter(Perpetrator.Race == "White" & Victim.Race=="Black") %>% select(Date, Year, City, State, Perpetrator.Race, Victim.Race, Weapon, Incident) 
head(WhiteonBlack)
dim(WhiteonBlack)
```

```{r}
byWeapWonB <- group_by(WhiteonBlack, Weapon)
head(byWeapWonB)

```

```{r}
sumWeapWonB <- summarise(byWeapWonB, count = n())
```

```{r}
WhonBlYear <- group_by(byWeapWonB, Year)
head(WhonBlYear)
dim(WhonBlYear)
b <- ggplot(Homicide, aes(Year))
b + geom_bar(aes(fill = Victim.Race))

Yearly <- group_by(Homicide, Year)
head(Yearly)
YearRace <-  Yearly %>%  group_by(Year, Perpetrator.Race)
YearCounts <- summarise(Yearly, count = n())
RaceCounts <- summarise(YearRace, countn = n())
head(RaceCounts, 20)
dim(RaceCounts)
colors <- c("red","blue", "green", "yellow", "orange")
head(YearCounts)
a <- ggplot(data = RaceCounts, aes(x = Year, y = countn, group = Perpetrator.Race, color = Perpetrator.Race, shape = Perpetrator.Race)) + 
    geom_line(size=1.5) + 
    geom_point(size=3, fill="white") +
    scale_shape_manual(values=c(22,21, 22,23,24))
a
```







```{r}
a <- ggplot(Homicide,aes(Weapon))
a  + geom_bar()
b <- ggplot(Homicide, aes(Perpetrator.Race))
```



```{r}
b + geom_bar(color = "Red", fill = "Orange")
```









